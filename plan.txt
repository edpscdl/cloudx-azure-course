az extension add --name containerapp --upgrade
az provider register --namespace Microsoft.App
az provider register --namespace Microsoft.OperationalInsights
az provider register --namespace Microsoft.AzureTerraform

az extension add --name serviceconnector-passwordless --upgrade
az extension add --name microsoft-entra-admin

# Create Azure Active Directory B2C
# Get values: nameOfApplication, clientId, clientSecret, name of sign-up-or-sign-in user flow, name of password-reset user flow
# Put this values in terraform.tfvars


# Run Terraform
# Update logout URL in Active Directory B2C

az ad sp create-for-rbac --name "heorhi_utseuski_github_actions" --json-auth

{
  "clientId": "<client_id>",
  "clientSecret": "<client_secret>",
  "subscriptionId": "<subscription_id>",
  "tenantId": "<tenant_id>"
}

az role assignment create \
    --assignee <client_id> \
    --role "Container Apps Contributor" \
    --scope /subscriptions/<subscription_id>/resourceGroups/<resource_group_name>

az role assignment create \
    --assignee <client_id> \
    --role "Web Plan Contributor" \
    --scope /subscriptions/<subscription_id>/resourceGroups/<resource_group_name>

az role assignment create \
    --assignee <client_id> \
    --role "Website Contributor" \
    --scope /subscriptions/<subscription_id>/resourceGroups/<resource_group_name>

az role assignment create \
    --assignee <client_id> \
    --role "AcrPush" \
    --scope /subscriptions/<subscription_id>/resourceGroups/<resource_group_name>/providers/Microsoft.ContainerRegistry/registries/<acr_name>

az role assignment create \
    --assignee <client_id> \
    --role "Contributor" \
    --scope /subscriptions/<subscription_id>/resourceGroups/<resource_group_name>/providers/Microsoft.ContainerRegistry/registries/<acr_name>

# Build and delpoy on GitHub
